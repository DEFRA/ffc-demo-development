#!/usr/bin/env sh

##
# Stop script
#
# Stop all services managed by this project.
##

set -e
projectRoot=$(a="/$0"; a=${a%/*}; a=${a:-.}; a=${a#/}/; cd "$a/.." || return; pwd)

(
  cd "${projectRoot}"

  docker-compose \
    -f services/ffc-demo-web/docker-compose.yaml \
    -f services/ffc-demo-web/docker-compose.link.yaml \
  down -v $@
  docker-compose \
    -f services/ffc-demo-api-gateway/docker-compose.yaml \
    -f services/ffc-demo-api-gateway/docker-compose.link.yaml \
  down -v $@
  docker-compose \
    -f services/ffc-demo-user-service/docker-compose.yaml \
    -f services/ffc-demo-user-service/docker-compose.link.yaml \
  down -v $@
  docker-compose \
    -f services/ffc-demo-claim-service/docker-compose.yaml \
    -f services/ffc-demo-claim-service/docker-compose.link.yaml \
  down -v $@
  docker-compose \
    -f services/ffc-demo-payment-service/docker-compose.yaml \
    -f services/ffc-demo-payment-service/docker-compose.link.yaml \
  down -v $@
  docker-compose \
    -f services/ffc-demo-payment-service-core/docker-compose.yaml \
    -f services/ffc-demo-payment-service-core/docker-compose.development.yaml \
    -f services/ffc-demo-payment-service-core/docker-compose.link.yaml \
  down -v $@
  docker-compose \
    -f services/ffc-demo-calculation-service/docker-compose.yaml \
    -f services/ffc-demo-calculation-service/docker-compose.link.yaml \
  down -v $@ 

  scripts/stop-core
)
